<!doctype html>
<html>
  <head>
    <meta charset="utf=8">
    <title>Plasma</title>
    <script type="text/javascript" src="../../processing.js"></script>
    <link type="text/css" rel="stylesheet" href="../style.css"/>
  </head>
  <body>
    <h4><a href="http://processingjs.org/">Processing.js</a> > <a href="index.html">Topic Demos</a> > Effects</h4>
    <h1>Plasma</h1>
    <p>Plasma demo effect by luis2048.</p>
    <p>Cycles of changing colours warped to give an illusion of liquid, organic movement.Colors are the sum of sine functions and various formulas. Based on formula by Robert Klep.</p>
    <p><a href="http://processing.org/learning/topics/plasma.html"><b>Original Processing.org Example:</b> Plasma</a></p>
    <script id='pjs_code' type="application/processing">
      int pixelSize=2;
      PGraphics pg;
      
      void setup(){
        size(356, 200);
        // Create buffered image for plasma effect
        pg = createGraphics(160, 90, P2D);
        colorMode(HSB);
        noSmooth();
      }
      
      void draw()
      {
        float  xc = 25;
      
        // Enable this to control the speed of animation regardless of CPU power
        // int timeDisplacement = millis()/30;
      
        // This runs plasma as fast as your computer can handle
        int timeDisplacement = frameCount;
      
        // No need to do this math for every pixel
        float calculation1 = sin( radians(timeDisplacement * 0.61655617));
        float calculation2 = sin( radians(timeDisplacement * -3.6352262));
        
        // Output into a buffered image for reuse
        pg.beginDraw();
        pg.loadPixels();
      
        // Plasma algorithm
        for (int x = 0; x < pg.width; x++, xc += pixelSize)
        {
          float  yc    = 25;
          float s1 = 128 + 128 * sin(radians(xc) * calculation1 );
      
          for (int y = 0; y < pg.height; y++, yc += pixelSize)
          {
            float s2 = 128 + 128 * sin(radians(yc) * calculation2 );
            float s3 = 128 + 128 * sin(radians((xc + yc + timeDisplacement * 5) / 2));  
            float s  = (s1+ s2 + s3) / 3;
            pg.pixels[x+y*pg.width] = color(s, 255 - s / 2.0, 255);
          }
        }   
        pg.updatePixels();
        pg.endDraw();
      
        // display the results
        image(pg,0,0,width,height); 
      
      }
    </script>
    <canvas></canvas>
    <pre id="show_code"></pre>
    <script type="text/javascript">
      var pre = '<b>// All Examples Written by <a href="http://reas.com/">Casey Reas</a> and <a href="http://benfry.com/">Ben Fry</a><br>// unless otherwise stated.</b><br>';
      document.getElementById('show_code').innerHTML = pre + document.getElementById('pjs_code').innerHTML.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n {6}/g,'<br>');
    </script>
  </body>
</html>
